# CLAUDE.md - AI Implementation Instructions

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ Claude Code ãŠã‚ˆã³ Claude AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã‚€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

> **ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦**:
> ã“ã®CLAUDE.mdã¯ã€Œå‚ç…§ã•ã‚Œã‚‹ã‚¬ã‚¤ãƒ‰ã€ã§ã™ã€‚
> åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®CLAUDE.mdã‹ã‚‰å‚ç…§ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚
>
> **æ¨å¥¨**: åˆã‚ã¦èª­ã‚€å ´åˆã¯ã€ã¾ãš `LLM_BOOTSTRAP.md` ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚

> **é‡è¤‡ã«ã¤ã„ã¦**:
> `LLM_BOOTSTRAP.md` ã¨ä¸€éƒ¨å†…å®¹ãŒé‡è¤‡ã—ã¦ã„ã¾ã™ãŒã€
> ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½“ã ã‘ã‚’èª­ã‚€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆã‚·ãƒŠãƒªã‚ªBï¼‰ã‚’æƒ³å®šã—ã€
> ã‚ãˆã¦ç¦æ­¢äº‹é …ã‚„åŸºæœ¬ãƒ«ãƒ¼ãƒ«ã‚’å†æ²ã—ã¦ã„ã¾ã™ã€‚
>
> **æ­£æœ¬**:
> - **ç¦æ­¢äº‹é …ï¼ˆNEVER-DOï¼‰**: `catalog/COMMON_MISTAKES.md`
> - **ãƒ‘ã‚¿ãƒ¼ãƒ³æ—©è¦‹è¡¨ãƒ»åŸºæœ¬ãƒ«ãƒ¼ãƒ«**: `LLM_BOOTSTRAP.md`

> **è©³ç´°ç‰ˆ**: ã‚ˆã‚Šè©³ã—ã„æƒ…å ±ã¯ `AGENTS.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ğŸš¨ CRITICAL: å®Ÿè£…å‰ã«å¿…ãšèª­ã‚€ã“ã¨

**ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚«ã‚¿ãƒ­ã‚°é§†å‹•é–‹ç™ºã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚ç‹¬è‡ªå®Ÿè£…ã¯ç¦æ­¢ã§ã™ã€‚**

### âš ï¸ è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚ºãŒå¿…è¦ã‹åˆ¤æ–­ã™ã‚‹ï¼ˆæœ€åˆã«ç¢ºèªï¼‰

**ä»¥ä¸‹ã®æ¡ä»¶ã«1ã¤ã§ã‚‚è©²å½“ã™ã‚‹å ´åˆã€è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚ºã‚’å…ˆã«å®Ÿè¡Œã™ã‚‹ã“ã¨ï¼š**

| æ¡ä»¶ | è©²å½“ä¾‹ |
|-----|-------|
| âœ… æ–°è¦æ©Ÿèƒ½ã®è¿½åŠ  | ã€Œã€‡ã€‡æ©Ÿèƒ½ã‚’ä½œã£ã¦ã€ã€Œã€‡ã€‡ç”»é¢ã‚’è¿½åŠ ã€ |
| âœ… 3ãƒ•ã‚¡ã‚¤ãƒ«ä»¥ä¸Šã®ä½œæˆãŒäºˆæƒ³ã•ã‚Œã‚‹ | Command + Handler + Validator + UI ãªã© |
| âœ… è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã®çµ„ã¿åˆã‚ã›ãŒå¿…è¦ | CRUD + çŠ¶æ…‹é·ç§» + é‡è¤‡ãƒã‚§ãƒƒã‚¯ |
| âœ… UIãŒã‚ã‚‹ | ç”»é¢ã€ãƒ•ã‚©ãƒ¼ãƒ ã€ä¸€è¦§è¡¨ç¤ºãªã© |
| âœ… ãƒ‰ãƒ¡ã‚¤ãƒ³å›ºæœ‰ã®æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ | è²¸å‡ºãƒ«ãƒ¼ãƒ«ã€äºˆç´„ãƒ«ãƒ¼ãƒ«ã€æ‰¿èªãƒ•ãƒ­ãƒ¼ãªã© |
| âœ… éæ©Ÿèƒ½è¦ä»¶ã®è€ƒæ…®ãŒå¿…è¦ | ç›£æŸ»ãƒ­ã‚°ã€åŒæ™‚å®Ÿè¡Œåˆ¶å¾¡ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã© |

```
è©²å½“ã™ã‚‹å ´åˆ â†’ catalog/planning/PLANNING_GUIDE.md ã‚’å…ˆã«èª­ã‚€
è©²å½“ã—ãªã„å ´åˆ â†’ ä¸‹è¨˜ã®å®Ÿè£…ã‚¬ã‚¤ãƒ‰ã«é€²ã‚€
```

### è¨ˆç”»ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹æ¡ä»¶

ä»¥ä¸‹ã®å ´åˆã®ã¿ã€è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚ºã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ç›´æ¥å®Ÿè£…å¯èƒ½ï¼š

```
âœ… å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£ï¼ˆãƒã‚°ä¿®æ­£ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼‰
âœ… æ—¢å­˜æ©Ÿèƒ½ã¸ã®å°ã•ãªå¤‰æ›´
âœ… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•°ã®ç½®æ›ã®ã¿ã§å®Œäº†ã™ã‚‹å®Ÿè£…
âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°
```

---

### ãƒ­ãƒ¼ã‚«ãƒ«ã‚«ã‚¿ãƒ­ã‚°ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹å ´åˆ

ã“ã®ã‚«ã‚¿ãƒ­ã‚°ã‚’åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆProjectXï¼‰ã«ãƒ™ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆã‚³ãƒ”ãƒ¼ï¼‰ã—ã¦ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

**é‡è¦ãªãƒ«ãƒ¼ãƒ«**:
- `./catalog/` ãŒå”¯ä¸€ã®å‚ç…§å…ƒï¼ˆå¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯å‚ç…§ã—ãªã„ï¼‰
- ã‚«ã‚¿ãƒ­ã‚°ã¯èª­ã¿å–ã‚Šå°‚ç”¨ï¼ˆæ›¸ãæ›ãˆãªã„ï¼‰
- å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ã€Œææ¡ˆã€ã¨ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã§èª¬æ˜

è©³ç´°: `catalog/consumer-example/README.md` ãŠã‚ˆã³ `catalog/INTEGRATION_WITH_SPEC.md` å‚ç…§

---

### èª­ã¿è¾¼ã¿å„ªå…ˆé †ä½ï¼ˆå¿…é ˆï¼‰

| é †åº | ãƒ•ã‚¡ã‚¤ãƒ« | ç›®çš„ | å¿…é ˆåº¦ |
|:---:|----------|------|:------:|
| 0 | `LLM_BOOTSTRAP.md` | AIã®å…¥å£ï¼ˆè¶…è¦ç´„ç‰ˆï¼‰ | **æ¨å¥¨** |
| 1 | `catalog/LLM_PATTERN_INDEX.md` | ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠæ—©è¦‹è¡¨ï¼ˆMarkdownç‰ˆï¼‰ | **æ¨å¥¨** |
| 2 | `catalog/AI_USAGE_GUIDE.md` | å®Ÿè£…ãƒ«ãƒ¼ãƒ«ãƒ»åˆ¶ç´„ãƒ»UIé…ç½®ãƒ«ãƒ¼ãƒ« | **å¿…é ˆ** |
| 3 | `catalog/index.json` | ãƒ‘ã‚¿ãƒ¼ãƒ³ç´¢å¼•ãƒ»æ„æ€æ±ºå®šãƒãƒˆãƒªã‚¯ã‚¹ | **å¿…é ˆ** |
| 4 | `catalog/COMMON_MISTAKES.md` | é »å‡ºãƒŸã‚¹ã¨å›é¿æ–¹æ³• | **å¿…é ˆ** |
| 5 | `catalog/DECISION_FLOWCHART.md` | ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | æ¨å¥¨ |
| 6 | `catalog/INTEGRATION_WITH_SPEC.md` | SPEC/Manifesté€£æºè¨­è¨ˆ | å‚ç…§ |

### åŸºç›¤ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆKernelï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | ç›®çš„ | å¿…é ˆåº¦ |
|----------|------|:------:|
| `catalog/kernel/result-pattern.yaml` | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°åŸºç›¤ï¼ˆResult<T>ï¼‰ | **å¿…é ˆ** |
| `catalog/kernel/value-object.yaml` | å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŸºåº•ã‚¯ãƒ©ã‚¹ | å‚ç…§ |
| `catalog/kernel/entity-base.yaml` | ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£åŸºåº•ã‚¯ãƒ©ã‚¹ | å‚ç…§ |

**ã“ã‚Œã‚‰ã‚’èª­ã¾ãšã«å®Ÿè£…ã‚’é–‹å§‹ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚**

---

## ğŸš¨ è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚º: Boundaryãƒ¢ãƒ‡ãƒªãƒ³ã‚°å¿…é ˆåŒ–ï¼ˆCRITICALï¼‰

**UIãŒã‚ã‚‹æ©Ÿèƒ½ã‚’è¨ˆç”»ã™ã‚‹éš›ã€Boundaryãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã‚’å¿˜ã‚Œã‚‹å•é¡ŒãŒé »ç™ºã—ã¦ã„ã¾ã™ã€‚**

### AIã®å­¦ç¿’ãƒã‚¤ã‚¢ã‚¹å•é¡Œ

```
å¤å…¸çš„DDDã¯UIã‚’å¯¾è±¡å¤–ã¨ã™ã‚‹ãŸã‚ã€AIã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«ã¯
ã€ŒBoundaryã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã€ã¨ã„ã†ç™ºæƒ³ãŒã»ã¨ã‚“ã©å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

ã“ã‚Œã¯ã€ŒBoundaryãŒé‡è¦ã€ã¨ã„ã†èª¬æ˜ã§ã¯è§£æ±ºã§ãã¾ã›ã‚“ã€‚
æˆæœç‰©ï¼ˆè¨ˆç”»æ›¸ãƒ»ä»•æ§˜æ›¸ï¼‰ã§å¼·åˆ¶ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```

### è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚ºã®å¿…é ˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³

| æ¡ä»¶ | å¿…é ˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|------|--------------|
| UIãŒã‚ã‚‹ | `boundary-pattern.yaml` ã‚’èª­ã‚€ â†’ Boundaryã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨ˆç”»ã«å«ã‚ã‚‹ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾è©±ãŒã‚ã‚‹ | Intentï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ„å›³ï¼‰ã‚’åˆ—æŒ™ |
| æ“ä½œå¯å¦åˆ¤å®šãŒã‚ã‚‹ | Entity.CanXxx() ã‚’è¨­è¨ˆ |

### è¨ˆç”»ãŒä¸å®Œå…¨ã¨ã¿ãªã•ã‚Œã‚‹æ¡ä»¶

```
âŒ UIãŒã‚ã‚‹ã®ã« Boundary ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒãªã„ â†’ ä¸å®Œå…¨
âŒ Intent ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„ â†’ ä¸å®Œå…¨
âŒ Entity.CanXxx() ã®è¨­è¨ˆãŒãªã„ â†’ ä¸å®Œå…¨
âŒ ã€Œå¾Œã‹ã‚‰ Boundary ã‚’è¿½åŠ ã™ã‚‹ã€ã¨ã„ã†è¨ˆç”» â†’ ä¸å®Œå…¨
âŒ boundary-pattern.yaml ã‚’èª­ã¾ãšã«è¨ˆç”»ã‚’ç«‹ã¦ãŸ â†’ ä¸å®Œå…¨
```

### ä»•æ§˜æ›¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

> **å‚ç…§**: `catalog/scaffolds/spec-template.yaml`

ä»•æ§˜æ›¸ã‚’ä½œæˆã™ã‚‹éš›ã¯ã€ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
`boundary` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## âš–ï¸ å®Ÿè£…å„ªå…ˆé †ä½ï¼ˆCRITICALï¼‰

**ã‚«ã‚¿ãƒ­ã‚°ã®ãƒ«ãƒ¼ãƒ«ã¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®æ…£ç¿’ãŒçŸ›ç›¾ã™ã‚‹å ´åˆã¯ã€å¿…ãšã‚«ã‚¿ãƒ­ã‚°ã‚’å„ªå…ˆã™ã‚‹ã€‚**

| é †ä½ | å„ªå…ˆåº¦ | èª¬æ˜ |
|:---:|--------|------|
| 1 | **æœ€å„ªå…ˆ** | ã‚«ã‚¿ãƒ­ã‚°ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ«ãƒ¼ãƒ« |
| 2 | æ¬¡ç‚¹ | ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆBlazorç­‰ï¼‰ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ |
| 3 | æœ€å¾Œ | ä¸€èˆ¬çš„ãªæ…£ç¿’ |

### å…·ä½“ä¾‹

```
âŒ Blazorã®æ…£ç¿’: Pages/ ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å¯èƒ½ãƒšãƒ¼ã‚¸ã‚’é…ç½®
âœ… ã‚«ã‚¿ãƒ­ã‚°ã®è¦å‰‡: æ©Ÿèƒ½å›ºæœ‰ãƒšãƒ¼ã‚¸ã¯ Features/{Feature}/ ã«é…ç½®

â†’ ã‚«ã‚¿ãƒ­ã‚°ã®è¦å‰‡ã‚’å„ªå…ˆã™ã‚‹
```

---

## â›” çµ¶å¯¾ç¦æ­¢äº‹é …ï¼ˆNEVER DOï¼‰

> **æ­£æœ¬**: `catalog/COMMON_MISTAKES.md` ã‚’å¿…ãšå…ˆã«èª­ã¿ã€å¸¸ã«ãã¡ã‚‰ã‚’å„ªå…ˆã—ã¦ãã ã•ã„ã€‚
> ä»¥ä¸‹ã¯ä»£è¡¨ä¾‹ã®ã¿ã§ã™ã€‚è©³ç´°ãƒ»æ›´æ–°ã¯ã™ã¹ã¦æ­£æœ¬å´ã§ç®¡ç†ã—ã¾ã™ã€‚

```
âŒ Handlerå†…ã§SaveChangesAsync()ã‚’å‘¼ã°ãªã„ â†’ TransactionBehaviorãŒè‡ªå‹•å®Ÿè¡Œ
âŒ BoundaryServiceã«æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆifæ–‡ï¼‰ã‚’æ›¸ã‹ãªã„ â†’ Entity.CanXxx()ã«å§”è­²
âŒ ä¾‹å¤–ã‚’throwã—ã¦ã‚¨ãƒ©ãƒ¼ã‚’ä¼æ’­ã—ãªã„ â†’ Result<T>ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨
```

**å®Œå…¨ãªãƒªã‚¹ãƒˆ**: `catalog/COMMON_MISTAKES.md` ã‚’å‚ç…§

---

## âœ… å¿…é ˆãƒ‘ã‚¿ãƒ¼ãƒ³

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- **Vertical Slice Architecture (VSA)**: æ©Ÿèƒ½å˜ä½ã§å‚ç›´çµ±åˆ
- **CQRS**: Command/Queryè²¬å‹™åˆ†é›¢ï¼ˆMediatRä½¿ç”¨ï¼‰
- **Pipeline Behaviors**: æ¨ªæ–­çš„é–¢å¿ƒäº‹ã®è‡ªå‹•å®Ÿè¡Œ

### å®Ÿè£…è¦ç´„

```csharp
// Command ã®æˆ»ã‚Šå€¤ã¯å¿…ãš Result<T>
public sealed record CreateProductCommand(...) : ICommand<Result<Guid>>;

// Handler ã¯ SaveChangesAsync ã‚’å‘¼ã°ãªã„ï¼ˆTransactionBehavior ãŒè‡ªå‹•å®Ÿè¡Œï¼‰
public async Task<Result<Guid>> Handle(CreateProductCommand request, CancellationToken ct)
{
    var entity = new Product(...);
    await _repository.AddAsync(entity, ct);
    return Result.Success(entity.Id);  // SaveChangesAsync ã¯å‘¼ã°ãªã„ï¼
}

// ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ã¯ Scoped
services.AddScoped<IProductRepository, ProductRepository>();
```

---

## ğŸ¯ ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠã®æ—©è¦‹è¡¨

### æ©Ÿèƒ½ã‚¹ãƒ©ã‚¤ã‚¹ï¼ˆFeature Slicesï¼‰

| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ | é¸æŠãƒ‘ã‚¿ãƒ¼ãƒ³ |
|---------------|-------------|
| ã€Œã€‡ã€‡ã‚’ä½œæˆã™ã‚‹æ©Ÿèƒ½ã€ | `feature-create-entity` |
| ã€Œã€‡ã€‡ã‚’æ¤œç´¢ã™ã‚‹ç”»é¢ã€ | `feature-search-entity` |
| ã€Œã€‡ã€‡ã‚’ç·¨é›†ã§ãã‚‹ã‚ˆã†ã«ã€ | `feature-update-entity` |
| ã€Œã€‡ã€‡ã‚’å‰Šé™¤ã™ã‚‹ã€ | `feature-delete-entity` |
| ã€ŒCSVã‚¤ãƒ³ãƒãƒ¼ãƒˆã€ | `feature-import-csv` |
| ã€ŒCSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ | `feature-export-csv` |
| ã€Œæ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€ | `feature-approval-workflow` |
| ã€Œãƒ­ã‚°ã‚¤ãƒ³ãƒ»èªè¨¼ã€ | `feature-authentication` |

### ã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆQuery Patternsï¼‰

| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ | é¸æŠãƒ‘ã‚¿ãƒ¼ãƒ³ |
|---------------|-------------|
| ã€Œä¸€è¦§ã‚’å–å¾—ã€ | `query-get-list` |
| ã€ŒIDã§è©³ç´°ã‚’å–å¾—ã€ | `query-get-by-id` |
| ã€Œä»Šæ—¥/ä»Šé€±/æœŸé–“ã§å–å¾—ã€ | `query-get-by-period` |
| ã€Œç©ºãæ¤œç´¢ãƒ»NOT EXISTSã€ | `complex-query-service` |

### ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆDomain Patternsï¼‰

| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ | é¸æŠãƒ‘ã‚¿ãƒ¼ãƒ³ |
|---------------|-------------|
| ã€Œæ™‚é–“æ ãƒ»äºˆç´„æ™‚é–“ã®ç®¡ç†ã€ | `domain-timeslot` |
| ã€Œå‹å®‰å…¨IDï¼ˆBookingIdç­‰ï¼‰ã€ | `domain-typed-id` |
| ã€Œé‡è¤‡ãƒã‚§ãƒƒã‚¯ãƒ»åœ¨åº«ç¢ºèªã€ | `domain-validation-service` |
| ã€ŒçŠ¶æ…‹é·ç§»ã®ç®¡ç†ã€ | `domain-state-machine` |
| ã€Œæ“ä½œå¯å¦ã®åˆ¤å®šã€ | `boundary-pattern` |

### æ¨ªæ–­çš„é–¢å¿ƒäº‹ï¼ˆPipeline Behaviorsï¼‰

| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ | é¸æŠãƒ‘ã‚¿ãƒ¼ãƒ³ |
|---------------|-------------|
| ã€Œã™ã¹ã¦ã®Commandã«ã€‡ã€‡ã€ | å„ `*-behavior` |
| ã€Œã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§é«˜é€ŸåŒ–ã€ | `caching-behavior` |
| ã€ŒçŠ¶æ…‹ç®¡ç†ã€ | `layer-store` |

**åˆ¤æ–­ã«è¿·ã£ãŸå ´åˆ**: `feature-slice` ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é¸æŠ

---

## ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

> **è©³ç´°ã¯ `catalog/scaffolds/project-structure.yaml` ã‚’å‚ç…§**

```
src/
â”œâ”€â”€ Kernel/                           # DDDåŸºç›¤ï¼ˆEntity, ValueObject, AggregateRootï¼‰
â”œâ”€â”€ Domain/{BC}/                      # BCå›ºæœ‰ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆAggregateå˜ä½ã§ãƒ•ã‚©ãƒ«ãƒ€åˆ†ã‘ï¼‰
â”‚   â”œâ”€â”€ {Aggregate}/
â”‚   â””â”€â”€ Boundaries/
â”œâ”€â”€ Shared/
â”‚   â”œâ”€â”€ Application/                  # ICommand, IQuery, Result<T>ï¼ˆBCéä¾å­˜ï¼‰
â”‚   â””â”€â”€ Infrastructure/               # Behaviorsï¼ˆBCéä¾å­˜ï¼‰
â””â”€â”€ Application/
    â”œâ”€â”€ Features/{Feature}/           # VSAæ©Ÿèƒ½ã‚¹ãƒ©ã‚¤ã‚¹
    â”‚   â”œâ”€â”€ {Feature}Command.cs
    â”‚   â”œâ”€â”€ {Feature}CommandHandler.cs
    â”‚   â””â”€â”€ {Feature}.razor           # â˜… æ©Ÿèƒ½å›ºæœ‰UIï¼ˆåŒåˆ—é…ç½®ï¼‰
    â”œâ”€â”€ Infrastructure/{BC}/          # â˜… BCå›ºæœ‰ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆDbContext, Repositoryå®Ÿè£…ï¼‰
    â””â”€â”€ Components/                   # Blazorãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”±æ¥
        â”œâ”€â”€ Pages/                    # è¤‡æ•°æ©Ÿèƒ½ã§ä½¿ã†åŸºç›¤ãƒšãƒ¼ã‚¸
        â””â”€â”€ Shared/                   # BCæ¨ªæ–­ã®å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```

---

## ğŸ”„ å®Ÿè£…ãƒ•ãƒ­ãƒ¼

```
1. catalog/index.json ã‚’èª­ã‚€
2. ai_decision_matrix ã§ã‚«ãƒ†ã‚´ãƒªã‚’ç‰¹å®š
3. è©²å½“ãƒ‘ã‚¿ãƒ¼ãƒ³ã® YAML ã‚’èª­ã‚€
4. ai_guidance.common_mistakes ã‚’ç¢ºèª
5. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•°ã‚’ç½®æ›ã—ã¦ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
6. UIé…ç½®ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®
7. evidence ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã§å®Ÿè£…ä¾‹ã‚’ç¢ºèª
```

---

## ğŸ”„ Standard Generation Flowï¼ˆSPEC/Manifestçµ±åˆï¼‰

SPEC + Manifest ãŒã‚ã‚‹å ´åˆã®æ¨™æº–ç”Ÿæˆãƒ•ãƒ­ãƒ¼ã€‚
`specs/` ã¨ `manifests/` ãŒæä¾›ã•ã‚ŒãŸå ´åˆã€ã“ã¡ã‚‰ã®ãƒ•ãƒ­ãƒ¼ã‚’å„ªå…ˆã™ã‚‹ã€‚

### Phase 0: äº‹å‰èª­ã¿è¾¼ã¿

```
1. specs/{feature}/{slice}.spec.yaml ã‚’èª­ã‚€
2. manifests/{feature}/{slice}.manifest.yaml ã‚’èª­ã‚€
3. catalog/CHARACTERISTICS_CATALOG.md ã§èªå½™ã‚’ç¢ºèª
4. catalog_binding.from_catalog ã‹ã‚‰ãƒ‘ã‚¿ãƒ¼ãƒ³IDãƒªã‚¹ãƒˆã‚’å–å¾—
5. å„ãƒ‘ã‚¿ãƒ¼ãƒ³YAMLã‚’èª­ã¿è¾¼ã‚€
```

### Phase 1: éª¨çµ„ã¿ç”Ÿæˆï¼ˆNon-Creativeï¼‰

Manifestã® `non_creative` é ˜åŸŸã«åŸºã¥ãã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é©ç”¨ï¼š

| ã‚«ãƒ†ã‚´ãƒª | ãƒ‘ã‚¿ãƒ¼ãƒ³ | ç”Ÿæˆç‰© |
|---------|---------|-------|
| command_structure | feature-create-entity | Command.cs, Handler.cs |
| validation_pipeline | validation-behavior | Validator.csï¼ˆè‡ªå‹•é©ç”¨ï¼‰ |
| transaction_management | transaction-behavior | ï¼ˆè‡ªå‹•é©ç”¨ã€SaveChangesAsyncä¸è¦ï¼‰ |
| authorization | authorization-behavior | ï¼ˆå±æ€§ã§åˆ¶å¾¡ï¼‰ |
| audit_logging | audit-log-behavior | ï¼ˆè‡ªå‹•é©ç”¨ï¼‰ |

### Phase 2: Cross-cuttingé©ç”¨

SPECã® `characteristics` ã«åŸºã¥ãã€éæ©Ÿèƒ½è¦ä»¶ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ï¼š

| characteristic | é©ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ | å®Ÿè¡Œé †åº |
|---------------|-------------|:--------:|
| xcut:validation | validation-behavior | 100 |
| xcut:auth | authorization-behavior | 200 |
| xcut:idempotent | idempotency-behavior | 300 |
| xcut:cache | caching-behavior | 350 |
| xcut:transaction | transaction-behavior | 400 |
| xcut:audit | audit-log-behavior | 550 |
| xcut:logging | logging-behavior | 600 |

### Phase 3: Business Logicå®Ÿè£…ï¼ˆCreativeï¼‰

Manifestã® `creative` é ˜åŸŸã«åŸºã¥ãå®Ÿè£…ï¼š

```
â–¡ Domain Modelè¨­è¨ˆ
  â””â”€â”€ SPECã® domain_rules ã‚’å‚ç…§
  â””â”€â”€ Entity.CanXxx() ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…

â–¡ Validation Logic
  â””â”€â”€ SPECã® scenarios.exceptions ã‚’å‚ç…§
  â””â”€â”€ FluentValidation ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…

â–¡ Repository Interface
  â””â”€â”€ I{Entity}Repository.cs ã‚’ä½œæˆ
```

### Phase 4: UIå®Ÿè£…ï¼ˆCreativeï¼‰

SPECã® `boundary` å®šç¾©ã«åŸºã¥ãå®Ÿè£…ï¼š

```
â–¡ Store + Stateå®šç¾©
  â””â”€â”€ {Feature}Store.cs
  â””â”€â”€ {Feature}State.cs

â–¡ PageActionså®šç¾©
  â””â”€â”€ {Feature}PageActions.cs

â–¡ Razorã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  â””â”€â”€ Features/{Feature}/{Feature}.razor ã«é…ç½®
  â””â”€â”€ SPECã® boundary.input/output ã‚’å‚ç…§
```

### ç”Ÿæˆå®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

```
â–¡ Manifestã®non_creativeã¯ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé€šã‚Šã‹
â–¡ SaveChangesAsync()ã‚’å‘¼ã‚“ã§ã„ãªã„ã‹ï¼ˆTransactionBehaviorã«ä»»ã›ã‚‹ï¼‰
â–¡ Result<T>ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹
â–¡ UIã¯Features/{Feature}/ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã‹
â–¡ Entity.CanXxx()ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‹
â–¡ ICommand<Result<T>>ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ï¼ˆIRequest<T>ç›´æ¥ä½¿ç”¨ç¦æ­¢ï¼‰
```

---

## ğŸ“‹ æ¨å¥¨å®Ÿè£…é †åºï¼ˆæ©Ÿèƒ½ã‚¹ãƒ©ã‚¤ã‚¹å˜ä½ï¼‰

**1ã¤ã®æ©Ÿèƒ½ã‚’å®Œäº†ã—ã¦ã‹ã‚‰æ¬¡ã®æ©Ÿèƒ½ã¸é€²ã‚€ã€‚** ã“ã‚Œã«ã‚ˆã‚Šã€UIã‚’ä½œæˆã™ã‚‹æ™‚ç‚¹ã§ã€Œã“ã®.razorã¯ã©ã®æ©Ÿèƒ½ã®ä¸€éƒ¨ã‹ã€ãŒæ˜ç¢ºã«ãªã‚‹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature: Products                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Domain Entity/ValueObject                            â”‚
â”‚    â””â”€â”€ Product.cs, ProductId.cs                         â”‚
â”‚                                                         â”‚
â”‚ 2. Repository Interface                                 â”‚
â”‚    â””â”€â”€ IProductRepository.cs                            â”‚
â”‚                                                         â”‚
â”‚ 3. Command/Query + Handler                              â”‚
â”‚    â””â”€â”€ CreateProductCommand.cs                          â”‚
â”‚    â””â”€â”€ CreateProductCommandHandler.cs                   â”‚
â”‚                                                         â”‚
â”‚ 4. Validator                                            â”‚
â”‚    â””â”€â”€ CreateProductCommandValidator.cs                 â”‚
â”‚                                                         â”‚
â”‚ 5. UI (.razor) â˜… åŒã˜Featureãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®             â”‚
â”‚    â””â”€â”€ Features/CreateProduct/CreateProduct.razor       â”‚
â”‚                                                         â”‚
â”‚ 6. Infrastructure (Repositoryå®Ÿè£…)                      â”‚
â”‚    â””â”€â”€ ProductRepository.cs                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ å®Œäº†å¾Œã«æ¬¡ã®æ©Ÿèƒ½ã¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature: Orders                                         â”‚
â”‚ ...                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãªãœã“ã®é †åºã‹ï¼Ÿ

| å•é¡Œã®ã‚ã‚‹é †åº | æ¨å¥¨é †åº |
|--------------|---------|
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’å…¨éƒ¨ä½œã‚‹ â†’ UIã‚’å¾Œã‹ã‚‰è¿½åŠ  | æ©Ÿèƒ½ã”ã¨ã«UIå«ã‚ã¦å®Œäº† |
| UIãŒæ—¢å­˜æ§‹é€ ï¼ˆPages/ï¼‰ã«å¼•ããšã‚‰ã‚Œã‚‹ | UIä½œæˆæ™‚ã«æ©Ÿèƒ½ã®æ–‡è„ˆãŒæ˜ç¢º |

---

## ğŸ“ UIé…ç½®ãƒ«ãƒ¼ãƒ«ï¼ˆè¦ç´„ï¼‰

> **è©³ç´°ã¯ `catalog/scaffolds/project-structure.yaml` ã‚’å‚ç…§**

| æ¡ä»¶ | é…ç½®å ´æ‰€ |
|-----|---------|
| æ©Ÿèƒ½å›ºæœ‰UI | `Features/{Feature}/` ã« .cs ã¨åŒåˆ—é…ç½® |
| è¤‡æ•°æ©Ÿèƒ½ã§ä½¿ã†åŸºç›¤ãƒšãƒ¼ã‚¸ | `Components/Pages/` |
| BCæ¨ªæ–­ã®å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | `Components/Shared/` |

---

## ğŸ”² ãƒã‚¦ãƒ³ãƒ€ãƒªãƒ¼ï¼ˆè¦ç´„ï¼‰

> **è©³ç´°ã¯ `catalog/patterns/boundary-pattern.yaml` ã‚’å‚ç…§**

- ãƒã‚¦ãƒ³ãƒ€ãƒªãƒ¼ã¯ **UIã§ã¯ãªãã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ä¸€éƒ¨**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚·ã‚¹ãƒ†ãƒ ã«ã€Œæ„å›³ã€ã‚’ä¼ãˆã‚‹å¢ƒç•Œ
- Command/Query ãŒãƒã‚¦ãƒ³ãƒ€ãƒªãƒ¼ã®å®Ÿç¾å½¢æ…‹

### Entity.CanXxx() ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆé‡è¦ï¼‰

**æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã¯ Entity ãŒæŒã¤ã€‚BoundaryService ã¯å§”è­²ã®ã¿ã€‚**

```csharp
// Entity å´ï¼ˆæ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒã¤ï¼‰
public class Order : AggregateRoot<OrderId>
{
    public BoundaryDecision CanPay()
    {
        return Status switch
        {
            OrderStatus.Pending => BoundaryDecision.Allow(),
            OrderStatus.Paid => BoundaryDecision.Deny("æ—¢ã«æ”¯æ‰•ã„æ¸ˆã¿ã§ã™"),
            _ => BoundaryDecision.Deny("ã“ã®çŠ¶æ…‹ã§ã¯æ”¯æ‰•ã„ã§ãã¾ã›ã‚“")
        };
    }
}

// BoundaryService å´ï¼ˆå§”è­²ã®ã¿ï¼‰
public async Task<BoundaryDecision> ValidatePayAsync(OrderId id, CancellationToken ct)
{
    var order = await _repository.GetByIdAsync(id, ct);
    if (order == null)
        return BoundaryDecision.Deny("è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");  // å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã®ã¿

    return order.CanPay();  // â˜… Entity ã«å§”è­²
}
```

### ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Entity ã« CanXxx() ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã‹ï¼Ÿ
- [ ] BoundaryService ã«æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆifæ–‡ï¼‰ãŒãªã„ã‹ï¼Ÿ

---

## ğŸ“Š Pipeline Behavior å®Ÿè¡Œé †åº

| é †åº | Behavior | ç›®çš„ |
|:---:|----------|------|
| 50 | MetricsBehavior | ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›† |
| 100 | ValidationBehavior | å…¥åŠ›æ¤œè¨¼ï¼ˆFluentValidationï¼‰ |
| 200 | AuthorizationBehavior | èªå¯ãƒã‚§ãƒƒã‚¯ |
| 300 | IdempotencyBehavior | å†ªç­‰æ€§ä¿è¨¼ï¼ˆbetaï¼‰ |
| 350 | CachingBehavior | Queryçµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| 400 | TransactionBehavior | ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ + SaveChangesAsync |
| 550 | AuditLogBehavior | ç›£æŸ»ãƒ­ã‚° |
| 600 | LoggingBehavior | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚° |

---

## ğŸ”— ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

- **ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è¦§**: `catalog/README.md`
- **AIåˆ©ç”¨ã‚¬ã‚¤ãƒ‰**: `catalog/AI_USAGE_GUIDE.md`
- **æ„æ€æ±ºå®šãƒ•ãƒ­ãƒ¼**: `catalog/DECISION_FLOWCHART.md`
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°**: `docs/blazor-guide-package/docs/`
- **å®Ÿè£…ä¾‹**: `src/Application.Features/Features/`ï¼ˆCommand/Query/Handlerï¼‰ ã¨ `src/UI.Blazor/Features/`ï¼ˆ.razorï¼‰

---

**ã‚«ã‚¿ãƒ­ã‚°ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2025.12.05.1
**æœ€çµ‚æ›´æ–°**: 2025-12-05
